<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>btb.fit ‚Äì Settings</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Password gate modal -->
  <div id="password-modal" class="modal">
    <div class="login-card">
      <h2>Settings Access</h2>
      <p>Enter password to manage your settings.</p>
      <form id="password-form">
        <input type="password" id="password-input" placeholder="Enter admin password" required>
        <button type="submit" class="btn">Unlock Settings</button>
      </form>
      <p id="error-message" style="color: #ff6b6b; display: none; margin-top: 10px;">Incorrect password</p>
    </div>
  </div>

  <!-- Main app (hidden until password is correct) -->
  <div id="app" class="app hidden">
    <header>
      <div class="logo-container">
        <img src="assets/logo.png" alt="BTB Logo" class="logo-img" style="cursor: pointer;" onclick="window.location.href='index.html'">
        <div class="brand">
          <span class="brand-name">btb<span class="dot">.fit</span></span>
          <span class="brand-tag">Settings</span>
        </div>
      </div>
      <div id="user-bar" class="user-bar">
        <button id="back-to-admin-btn" class="btn secondary">Back to Admin</button>
        <button id="view-profile-btn" class="btn secondary">View Public Profile</button>
        <button id="logout-btn" class="btn secondary">Lock</button>
      </div>
    </header>

    <main style="display: flex; flex-direction: column; gap: 24px; max-width: 800px; margin: 0 auto;">
      <!-- Current Saved Data Display with Dropdown Editor -->
      <div class="card" style="background: linear-gradient(135deg, #1a2332 0%, #2a3847 100%); border: 2px solid #34e27c;">
        <h2 style="margin-bottom: 16px; color: #34e27c;">üìä Currently Saved Data</h2>
        <div id="saved-data-display">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Display Name</p>
              <p id="display-name-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Age</p>
              <p id="age-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Height</p>
              <p id="height-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Weight</p>
              <p id="weight-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Muscle %</p>
              <p id="muscle-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Body Fat %</p>
              <p id="body-fat-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Body Water %</p>
              <p id="body-water-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">Bone Mass</p>
              <p id="bone-mass-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
            <div>
              <p style="font-size: 12px; color: #9aa8c7; margin-bottom: 4px;">BMR</p>
              <p id="bmr-display" style="font-size: 16px; font-weight: 600; color: #e5e9f0;">Not set</p>
            </div>
          </div>
          
          <!-- Field Editor -->
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(52, 226, 124, 0.3);">
            <div style="display: flex; gap: 12px; align-items: flex-end;">
              <div style="flex: 1;">
                <label style="display: block; font-size: 12px; color: #9aa8c7; margin-bottom: 6px;">Select Field to Edit</label>
                <select id="field-selector" class="unit-select" style="width: 100%; padding: 8px;">
                  <option value="">-- Choose a field --</option>
                  <option value="displayName">Display Name</option>
                  <option value="age">Age</option>
                  <option value="height">Height</option>
                  <option value="weight">Weight</option>
                  <option value="muscle">Muscle %</option>
                  <option value="bodyFat">Body Fat %</option>
                  <option value="bodyWater">Body Water %</option>
                  <option value="boneMass">Bone Mass</option>
                  <option value="bmr">BMR</option>
                </select>
              </div>
            </div>
            
            <!-- Dynamic field editor (populated by JS) -->
            <div id="field-editor-container" style="margin-top: 12px; display: none;">
              <form id="field-edit-form">
                <div id="field-edit-content"></div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button type="submit" class="btn" style="flex: 1;">Save Change</button>
                  <button type="button" id="cancel-field-edit" class="btn secondary" style="flex: 1;">Cancel</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="background: #1a2332; border: 2px solid #ff6b6b;">
        <h2 style="color: #ff6b6b;">‚ö†Ô∏è Important Note</h2>
        <p style="font-size: 14px; color: #e5e9f0; line-height: 1.6;">
          <strong>Age, Height, and Weight are required</strong> before you can create any admin entries. Use the dropdown selector above to set these values first.
        </p>
        <button onclick="const b = localStorage.getItem('btb_baseline_btbga'); const p = localStorage.getItem('btb_profile_btbga'); alert('Baseline: ' + (b || 'EMPTY') + '\\n\\nProfile: ' + (p || 'EMPTY')); console.log('Baseline:', b); console.log('Profile:', p);" style="margin-top: 12px; padding: 8px 16px; background: #ff6b6b; color: white; border: none; border-radius: 4px; cursor: pointer;">
          üîç Check Stored Data
        </button>
      </div>

      <div class="card">
        <h2>Privacy Settings</h2>
        <p style="font-size: 13px; color: #9aa8c7; margin-bottom: 16px;">
          Control which modules are visible on your public profile
        </p>
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <label class="privacy-setting-row">
            <span class="privacy-label">Current Stats</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-silhouette" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">BMI Over Time</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-bmi" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Progress Chart</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-progress" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Athleticism Score</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-athleticism" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Water Intake</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-water" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Daily Macros</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-macros" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Body Composition</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-body-comp" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Weight Projections</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-projections" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Caloric Balance</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-caloric-balance" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Strength-to-Weight</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-strength-weight" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Body Recomposition</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-recomposition" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Consistency Tracker</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-consistency" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
          <label class="privacy-setting-row">
            <span class="privacy-label">Bone Density & BMR</span>
            <label class="privacy-toggle">
              <input type="checkbox" id="privacy-bone-bmr" checked>
              <span class="toggle-label">Public</span>
            </label>
          </label>
        </div>
      </div>

      <div class="card">
        <h2>Data Management</h2>
        <p style="font-size: 13px; color: #9aa8c7; margin-bottom: 16px;">
          Export or import your fitness data
        </p>
        <div style="display: flex; gap: 12px;">
          <button id="export-btn" class="btn secondary">Export Data</button>
          <button id="import-btn" class="btn secondary">Import Data</button>
        </div>
        <input type="file" id="import-file" accept=".json" style="display: none;">
      </div>
    </main>
  </div>

  <script src="settings.js?v=8"></script>
</body>
</html>
